–ù–∞–ø–∏—à–∏ –ø—Ä–∏–º–µ—Ä DAG-–∞, –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ mysql.
–ò—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
host: 10.112.128.79
login: rusalextern
port: 3306.
–ù–∞–ø—Ä–∏–º–µ—Ä, DAG –¥–ª—è —Ç–µ—Å—Ç–∞ –∫–∞–∫–æ–≥–æ-–Ω–∏–±—É–¥—å –ø—Ä–æ—Å—Ç–æ–≥–æ.

==========================

–ö–æ–Ω–µ—á–Ω–æ!  
–í–æ—Ç –ø—Ä–∏–º–µ—Ä DAG-–∞ –¥–ª—è *Apache Airflow*, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ MySQL –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π SQL-–∑–∞–ø—Ä–æ—Å.  

## üîπ *–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏*
–ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —ç—Ç–æ–≥–æ DAG-–∞ –¥–æ–±–∞–≤—å—Ç–µ *–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MySQL* –≤ *Airflow*.  

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ *Admin ‚Üí Connections* –≤ UI Airflow.  
2. –ù–∞–∂–º–∏—Ç–µ *"+ Add Connection"*.  
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:
   - *Conn Id*: `mysql_test`  
   - *Conn Type*: `MySQL`  
   - *Host*: `10.112.128.79`  
   - *Schema*: (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è –±–∞–∑–∞, —É–∫–∞–∂–∏—Ç–µ, –∏–Ω–∞—á–µ –æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º)  
   - *Login*: `rusalextern`  
   - *Password*: (–µ—Å–ª–∏ –µ—Å—Ç—å, —É–∫–∞–∂–∏—Ç–µ)  
   - *Port*: `3306`  

üìå *–í–∞–∂–Ω–æ*: –ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (`mysql_test`) –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ DAG-–µ.

---

## üìù *–ü—Ä–∏–º–µ—Ä DAG-–∞*
–≠—Ç–æ—Ç DAG –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ MySQL –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ—Å—Ç–æ–π SQL-–∑–∞–ø—Ä–æ—Å:

pythonfrom airflow import DAG
from airflow.providers.mysql.operators.mysql import MySqlOperator
from datetime import datetime

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∞—Ä–≥—É–º–µ–Ω—Ç—ã DAG-–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
default_args = {
    "owner": "Airflow",
    "start_date": datetime(2024, 6, 1),  # –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã DAG
    "retries": 1,  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ç—Ä–∞–µ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–µ
}

# –°–æ–∑–¥–∞—ë–º DAG
with DAG(
    dag_id="mysql_test_dag",
    default_args=default_args,
    schedule_interval="@daily",  # –ó–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å
    catchup=False,
) as dag:

    # –û–ø–µ—Ä–∞—Ç–æ—Ä –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è SQL-–∑–∞–ø—Ä–æ—Å–∞
    test_query = MySqlOperator(
        task_id="run_mysql_query",
        mysql_conn_id="mysql_test",  # –ò–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏–∑ Airflow
        sql="SELECT VERSION();",  # SQL-–∑–∞–ø—Ä–æ—Å, –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–æ–π
    )

    test_query  # –í—ã–ø–æ–ª–Ω—è–µ–º –∑–∞–¥–∞—á—É



---

## üîç *–ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç DAG?*
1. *–ö–∞–∂–¥—ã–π –¥–µ–Ω—å* –≤—ã–ø–æ–ª–Ω—è–µ—Ç SQL-–∑–∞–ø—Ä–æ—Å `"SELECT VERSION();"` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–∏ MySQL.  
2. *–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ* `mysql_test`, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –¥–æ–±–∞–≤–∏–ª–∏ –≤ Airflow UI.  
3. *–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏*, –ø–æ–≤—Ç–æ—Ä—è—è –ø–æ–ø—ã—Ç–∫—É –æ–¥–∏–Ω —Ä–∞–∑ (`"retries": 1`).  

## üöÄ *–†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ*
1. –î–æ–±–∞–≤—å—Ç–µ DAG –≤ –∫–∞—Ç–∞–ª–æ–≥ Airflow (`$AIRFLOW_HOME/dags/`):  
   
bash   cp mysql_test_dag.py $AIRFLOW_HOME/dags/
   
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Airflow Scheduler:  
   
bash   airflow scheduler
   
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ UI *"DAGs"* ‚Üí *`mysql_test_dag`*, –∑–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç–µ DAG –≤—Ä—É—á–Ω—É—é.

---

## ‚ùì *–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏*
–ï—Å–ª–∏ –Ω—É–∂–Ω—ã –¥—Ä—É–≥–∏–µ SQL-–∑–∞–ø—Ä–æ—Å—ã, –ø—Ä–æ—Å—Ç–æ –∑–∞–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫—É –≤ `MySqlOperator(sql=...)`.

‚ùóÔ∏è *–ï—Å–ª–∏ –ø–∞—Ä–æ–ª—å –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω*, –¥–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ *Airflow Connections*.  
üí° –ú–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å *schedule_interval* (`@daily`, `@hourly`, `None`, `*/15 * * * *`).
